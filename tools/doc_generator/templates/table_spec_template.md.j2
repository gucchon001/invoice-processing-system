{# Jinja2 テンプレート: テーブル設計詳細仕様書 #}
# 📊 テーブル設計詳細仕様書

**作成日**: {{ "now" | date:"%Y年%m月%d日" }}  
**バージョン**: 1.2 (自動生成)
**対象システム**: 請求書処理自動化システム  
**データベース**: Supabase PostgreSQL

---

## 📋 概要

本ドキュメントは請求書処理自動化システムの全テーブルの詳細仕様を定義します。  
**唯一のマスターデータ**は `master_data/tables.yml` にあり、このドキュメントはその内容を人間が読みやすい形式で**自動生成**したものです。

**設計原則**:
- **Single Source of Truth (SSOT)**: `tables.yml` が唯一の正
- **自動生成**: このファイルは `tools/doc_generator/generate_docs.py` によって自動生成される
- **可読性重視**: 開発者が概要を素早く把握できる構成

## 🗂️ テーブル一覧

| テーブル名 | 説明 | カラム数 |
|------------|------|----------|
{% for table_key, table_info in tables.items() %}
| [{{ table_info.name }}](#{{ loop.index }}-{{ table_key | replace('_', '') }}) | {{ table_info.description | truncate(30) }} | {{ table_info.columns | length }} |
{% endfor %}

---
{% for table_key, table_info in tables.items() %}
## {{ loop.index }}. **{{ table_info.name }}**

- **マスター定義**: `master_data/tables.yml -> tables.{{ table_key }}`
- **説明**: {{ table_info.description }}

### SQL定義
```sql
{{ table_info.sql_definition | indent(4) }}
```

### カラム仕様
| カラム名 | データ型 | 制約 | 説明 |
|----------|----------|--------|------|
{% for column in table_info.columns %}
| `{{ column.name }}` | `{{ column.type }}` | {{ column.constraints | default('-') }} | {{ column.description | default('-') }} |
{% endfor %}

### 業務ルール
<ul>
{% for rule in table_info.business_rules %}
  <li>{{ rule }}</li>
{% endfor %}
</ul>

---
{% endfor %}

## 🚀 今後の拡張

- 全テーブル定義を `master_data/tables.yml` に追加
- このMarkdownファイルを自動生成するスクリプト (`tools/doc_generator.py`) を拡充

---

**関連ドキュメント**:

### 📚 マスターデータ
- **master_data/tables.yml** - 全テーブル定義のマスターファイル

### 📚 統合設計書
- [15_システムアーキテクチャ設計書.md](../15_システムアーキテクチャ設計書.md)
- [16_データベース設計書.md](../16_データベース設計書.md)

... (以下略) 